@model CMM.Projects.Apresentation.Models.UnidadeModelView

@using CMM.Projects.Apresentation.Utils;

@{
    ViewData["TituloPagina"] = "Detalhes - " + Model.UND_SIGLA;


}
<div class="row m-b-15">
    <div class="col-sm-12">
        <div class="card">
            <div class="card-header text-uppercase">
                <span class="fa fa-gear"></span>  Dados da Unidade
            </div>
            <div class="card-body">
                <div class="row mt" style="font-size:medium">
                    <div class="col-lg-1 col-sm-12 col-xl-1">
                        <div class="form-group">
                            @Html.LabelFor(model => model.UND_ID, htmlAttributes: new { @class = "control-label" })
                            <br />
                            @Html.DisplayFor(model => model.UND_ID, new { htmlAttributes = new { @class = "form-control" } })

                        </div>
                    </div>

                    <div class="col-lg-2 col-sm-12 col-xl-2">
                        <div class="form-group">
                            @Html.LabelFor(model => model.UND_CODIGO, htmlAttributes: new { @class = "control-label" })
                            <br />
                            @Html.DisplayFor(model => model.UND_CODIGO, new { htmlAttributes = new { @class = "form-control" } })

                        </div>
                    </div>
                    <div class="col-lg-2 col-sm-12 col-xl-2">
                        @Html.LabelFor(model => model.UND_SIGLA, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @Html.DisplayFor(model => model.UND_SIGLA, new { htmlAttributes = new { @class = "form-control" } })

                    </div>

                    <div class="col-lg-4 col-sm-12 col-xl-4">
                        @Html.LabelFor(model => model.UND_NOME, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @Html.DisplayFor(model => model.UND_NOME, new { htmlAttributes = new { @class = "form-control" } })

                    </div>
                    <div class="col-lg-3 col-sm-12 col-xl-3">
                        @Html.LabelFor(model => model.UND_NIVEL, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @if (Model.UND_NIVEL.HasValue)
                        {
                            @Model.UND_NIVEL.Descricao()

                        }

                    </div>
                </div>
                <hr />
                <div class="row mt">
                    <div class="col-lg-2 col-sm-12 col-xl-2">
                        <div class="form-group">
                            @Html.LabelFor(model => model.UND_DATAINICIO, htmlAttributes: new { @class = "control-label" })
                            <br />
                            @if (Model.UND_DATAINICIO.HasValue)
                            {
                                @Model.UND_DATAINICIO.Value.ToShortDateString()

                            }

                        </div>
                    </div>

                    <div class="col-lg-2 col-sm-12 col-xl-2">
                        <div class="form-group">
                            @Html.LabelFor(model => model.UND_DATAFIM, htmlAttributes: new { @class = "control-label" })
                            <br />
                            @if (Model.UND_DATAFIM.HasValue)
                            {
                                @Model.UND_DATAFIM.Value.ToShortDateString()

                            }

                        </div>
                    </div>

                    <div class="col-lg-4 col-sm-12 col-xl-4">
                        @Html.LabelFor(model => model.UND_PAI, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @if (Model.UND_PAI.HasValue)
                        {
                            @Html.DisplayFor(model => model.UND_PAI_NOME, new { htmlAttributes = new { @class = "form-control" } })

                        }

                    </div>
                    <div class="col-lg-4 col-sm-12 col-xl-4">
                        @Html.LabelFor(model => model.UND_RAMAL, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @Html.DisplayFor(model => model.UND_RAMAL, new { htmlAttributes = new { @class = "form-control" } })



                    </div>


                </div>
                <div class="row mt">
                    <div class="col-lg-12 col-sm-12 col-xl-12">
                        @Html.LabelFor(model => model.UND_DIRETORIO, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @Html.DisplayFor(model => model.UND_DIRETORIO, new { htmlAttributes = new { @class = "form-control" } })

                    </div>
                </div>
                <div class="row mt">
                    <div class="col-lg-12 col-sm-12 col-xl-12">
                        @Html.LabelFor(model => model.UND_COMPETENCIA, htmlAttributes: new { @class = "control-label" })
                        <br />
                        @Html.DisplayFor(model => model.UND_COMPETENCIA, new { htmlAttributes = new { @class = "form-control" } })

                    </div>
                </div>
                @if (((List<CMM.Projects.Apresentation.Models.UnidadeModelView>)TempData["unidadeFilho"]).Count > 0)
                {
                    <br />
                    <div class="row mt">
                        <div class="col-lg-12 col-sm-12 col-xl-12">

                            <h6>Unidades subordinadas:</h6>
                            <ul style="list-style-type:circle;">




                                @foreach (var item in (List<CMM.Projects.Apresentation.Models.UnidadeModelView>)TempData["unidadeFilho"])
                                {

                                    <li>@item.UND_SIGLA - @item.UND_NOME</li>

                                }

                            </ul>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>
<div class="row m-b-15">
    <div class="col-sm-12">
        <div class="card">
            <div class="card-header text-uppercase">
                <span class="fa fa-user-o"></span>  Servidores
            </div>
            <div class="card-body">
                <div id="datatable-buttons_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">

                    <table class="table table-striped table-bordered dt-responsive nowrap dataTable no-footer dtr-inline collapsed" id="datatable">
                        <thead style="align-items:center">
                            <tr>

                                <th>
                                    ID
                                </th>
                                <th>
                                    NOME
                                </th>
                                <th>
                                    TIPO
                                </th>
                                <th>
                                    CARGO
                                </th>
                                <th>
                                    DATA ADMISSÃO
                                </th>
                                <th>
                                   INGRESSO NA UNIDADE
                                </th>

                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (((List<CMM.Projects.Apresentation.Models.VinculoModelView>)TempData["vinculoUnidade"]).Count > 0)
                            {
                                foreach (var item in (List<CMM.Projects.Apresentation.Models.VinculoModelView>)TempData["vinculoUnidade"])
                                {

                                    <tr>

                                        <td>
                                            @Html.DisplayFor(modelItem => item.FUN_ID)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.FUN_NOME)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.VNC_TIPO)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.CRG_NOME)
                                        </td>
                                        <td>
                                            @item.VNC_ADMISSAO.Value.ToShortDateString()
                                        </td>
                                        <td>
                                            @if (item.Lotacao.Any(x => x.UND_ID == Model.UND_ID && x.VNCU_DATAFIM == null))
                                            {
                                                @item.Lotacao.FirstOrDefault(x => x.UND_ID == Model.UND_ID && x.VNCU_DATAFIM == null).VNCU_DATAINICIO.Value.ToShortDateString();
                                            }
                                        </td>

                                        <td align="center">

                                            @Html.ActionLink("Visualizar Cadastro", "Cadastro", "Funcionario", new { id = item.FUN_ID }, new { @class = "btn-sm btn-outline-primary", @target = "_blank" })

                                        </td>
                                    </tr>

                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>
@section scripts{
    @Scripts.Render("~/bundles/Grid")
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/plug-ins/1.10.19/sorting/datetime-moment.js" type="text/javascript"></script>

    <script type="text/javascript">
        var dataTable;
        $(document).ready(function () {
            $.fn.dataTable.moment('DD/MM/YYYY');


            $("#datatable").dataTable({
                "autoWidth": false,
                "order":
                    [1, "asc"],
                "dom": '<"toolbar">frtip'
            });


        });



    </script>
}


